<!DOCTYPE html>
<html>
<head>
    <title>Navigation Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; background: white; padding: 20px; border-radius: 8px; }
        .button { 
            background: #007acc; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            margin: 5px; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 16px;
        }
        .button:hover { background: #005a9e; }
        .status { 
            background: #e7f3ff; 
            padding: 10px; 
            margin: 10px 0; 
            border-left: 4px solid #007acc; 
        }
        .error { 
            background: #ffe7e7; 
            border-left-color: #cc0000; 
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Navigation & Refresh Test</h1>
        <p><strong>Current Time:</strong> <span id="current-time"></span></p>
        <p><strong>Page Loaded:</strong> <span id="load-time"></span></p>
        
        <div class="status" id="status">Ready for testing...</div>
        
        <h2>Test Buttons</h2>
        <button class="button" onclick="testBasicClick()">Basic Click Test</button>
        <button class="button" onclick="testNavigation()">Test Navigation</button>
        <button class="button" onclick="testPageRefresh()">Force Page Refresh</button>
        <button class="button" onclick="clearLogs()">Clear Logs</button>
        
        <h2>Navigation Links</h2>
        <a href="/chat" class="button">Go to /chat</a>
        <a href="/knowledge-base" class="button">Go to /knowledge-base</a>
        <a href="/dashboard" class="button">Go to /dashboard</a>
        
        <h2>Console Logs</h2>
        <div id="logs" style="background: #f8f8f8; padding: 10px; height: 200px; overflow-y: scroll; font-family: monospace; font-size: 12px;"></div>
    </div>

    <script>
        let refreshCount = 0;
        let startTime = new Date();
        
        // Log function
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logElement = document.getElementById('logs');
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(`[${timestamp}] ${message}`);
        }
        
        // Update time every second
        function updateTime() {
            document.getElementById('current-time').textContent = new Date().toLocaleString();
            
            // Check if page is refreshing by comparing timestamps
            const now = new Date();
            const timeDiff = (now - startTime) / 1000;
            
            if (timeDiff < 2 && refreshCount > 0) {
                log('‚ö†Ô∏è POSSIBLE REFRESH DETECTED - Page reloaded quickly');
                document.getElementById('status').className = 'status error';
                document.getElementById('status').textContent = 'REFRESH DETECTED!';
            }
        }
        
        // Test functions
        function testBasicClick() {
            log('‚úÖ Basic click test - button works');
            document.getElementById('status').textContent = 'Button clicked successfully!';
        }
        
        function testNavigation() {
            log('üîÑ Testing navigation...');
            window.location.hash = '#test-' + Date.now();
            log('‚úÖ Hash navigation successful');
        }
        
        function testPageRefresh() {
            log('üîÑ Forcing page refresh...');
            refreshCount++;
            localStorage.setItem('refreshCount', refreshCount);
            window.location.reload();
        }
        
        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
            log('üßπ Logs cleared');
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            refreshCount = parseInt(localStorage.getItem('refreshCount') || '0');
            document.getElementById('load-time').textContent = startTime.toLocaleString();
            
            log('üöÄ Page loaded and script initialized');
            log(`üìä Refresh count: ${refreshCount}`);
            
            if (refreshCount > 0) {
                log('‚ö†Ô∏è This page has been refreshed before');
            }
            
            // Start time updates
            setInterval(updateTime, 1000);
            updateTime();
            
            // Monitor for unexpected reloads
            window.addEventListener('beforeunload', function() {
                log('üö™ Page about to unload');
            });
            
            // Monitor hash changes
            window.addEventListener('hashchange', function() {
                log('üîó Hash changed to: ' + window.location.hash);
            });
        });
        
        // Monitor console errors
        window.addEventListener('error', function(e) {
            log('‚ùå JavaScript error: ' + e.message);
        });
        
        // Monitor unhandled promise rejections
        window.addEventListener('unhandledrejection', function(e) {
            log('‚ùå Unhandled promise rejection: ' + e.reason);
        });
    </script>
</body>
</html>